Есть несколько результатов подчета аванса - нет выплаты/есть выплата; подсчет аванса в определенный день/подсчет аванса в конце месяца.

Первым проверяется процент аванса - если он равен нулю, аванс не выплачивается.

Следующим проверяется UseAdvDays - флаг, есть ли у компании фиксированный день выдачи аванса:
- если да, то для подсчета аванса выбирается период от первого дня месяца до дня аванса,
- если нет - то аванс будет высчитываться в конце текущего месяца.

Далее проверяется дата увольнения сотрудника - если она была раньше, чем день подсчета аванса, или в этот же день, то аванс не выплачивается.

Следующий шаг - подчет фактического периода работы сотрудника в промежутке от начала месяца и до дня подсчета аванса. Если это количество меньше, чем минимальное количество дней, положенных для аванса - аванс не выплачивается.

Далее по окладу, планововому рабочему времени по производственному календарю, отработанному времени и проценту аванса считается аванс. Соответственно, если плановое и фактическое время работы сотрудника равны - выплачивается чистый процент от оклада. Если они не равны: значение аванса увеличивается, когда увеличивается фактическое значение времени работы сотрудника, при этом у аванса и планового времени работы обратная зависимость. 

Сначала вычисляется заработок в час, затем умножается на фактическое значение времени работы сотрудника и берется процент от получившегося числа.