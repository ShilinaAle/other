Есть несколько результатов подчета аванса - нет выплаты/есть выплата; аванс в определенный день/аванс в конце месяца.

Первым проверяется процент аванса - если он равен нулю, аванс не выплачивается.

Следующим проверяется UseAdvDays - флаг, есть ли у компании фиксированный день выдачи аванса:
- если да, то для подсчета аванса выбирается первая часть месяца, путем сдвига дня аванса на конец периода выплаты,
- если нет - то аванс будет выплачиваться в конце текущего месяца.

Далее проверяется дата увольнения сотрудника - если она была раньше, чем день выплат, или в этот же день, то аванс не выплачивается.

Следующий шаг - подчет фактического периода работы сотрудника в промежутке от начала месяца и до дня получения аванса. Если это количество меньше, чем минимальное количество дней, положенных для аванса - аванс не выплачивается.

Далее по окладу, планововому рабочему времени по производственному календарю, отработанному времени и проценту аванса считается аванс. Соответственно, если плановое и фактическое время работы сотрудника равны - выплачивается чистый процент от оклада. Если они не равны: связь значения аванса и фактического времени работы сотрудника пропорциональная, а аванса и планового - обратно пропорциональная.
